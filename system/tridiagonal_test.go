package system

import (
	"testing"

	"github.com/ready-steady/support/assert"
)

func TestComputeTridiagonal(t *testing.T) {
	a := []float64{
		4.8075817741978699e-01, 1.2692671000342037e-01, 4.9831340044932859e-01,
		3.9611537773884853e-01, 8.4803219799756557e-01, 3.8361564524640535e-01,
		4.2271936732562421e-01, 2.9871494846480506e-01, 6.0343086813946123e-01,
		6.5050309033626463e-01, 6.2611305300575382e-01, 4.9016643252911518e-01,
		6.3228557723272305e-01, 8.0881918292978749e-03, 9.8142184023407009e-01,
		3.0011820727343141e-01, 1.0221196095348672e-01, 1.7152991176879773e-01,
		6.3234800301520455e-01, 6.4222978064709224e-01,
	}
	b := []float64{
		1.4305400424536181e+00, 1.1546425268361689e+00, 1.5528249265311795e+00,
		1.5046909633814507e+00, 1.3106321971636674e+00, 1.7723433981144341e+00,
		1.0930877721506009e+00, 1.8067166712036105e+00, 1.4064057825267366e+00,
		1.2810478325153505e+00, 1.9576080656029342e+00, 1.6020009934522998e+00,
		1.9283873223117676e+00, 1.5668820259614546e+00, 1.4354500051833838e+00,
		1.2600111255480502e+00, 1.4573886219153447e+00, 1.0769003298984701e+00,
		1.2457299327768727e+00, 1.7477107763931770e+00,
	}
	c := []float64{
		2.8548654494460557e-01, 5.8540758620217703e-01, 2.6850381977534676e-01,
		6.9258609074529653e-01, 3.1247923637358188e-01, 9.0156663656333069e-01,
		6.1005182073414899e-01, 3.7766783517906743e-01, 9.3237166831823881e-01,
		5.8777963759554253e-01, 4.6097285394375520e-01, 2.1253215171767503e-01,
		2.8937226325800802e-01, 1.2110782971154588e-01, 7.6345100838619318e-01,
		9.4948181851599811e-01, 9.2046644452877935e-01, 9.4207843361454224e-01,
		5.5613288144227369e-01, 3.2889132147476241e-01,
	}
	d := []float64{
		5.4345703792352307e-01, 2.5206603256969351e-01, 6.7212010426701829e-01,
		5.5742791550815585e-01, 1.5338438683979383e-01, 1.3141853627070477e-01,
		2.1725351445739172e-01, 3.0696424588099869e-01, 6.5854065921020499e-01,
		5.4972430745083167e-01, 6.8185426479854760e-01, 6.4746979094442436e-01,
		3.7339166209360886e-01, 5.5263882037533685e-01, 4.5130602770887251e-01,
		5.3739081485328155e-01, 3.0980792962149784e-01, 1.1107555117435641e-01,
		7.5049154682465413e-01, 3.4499665786432776e-01,
	}
	x := []float64{
		+3.8743269018574988e-01, -1.8416124759605874e-02, +3.2427337332838657e-01,
		+2.4678206444367387e-01, +7.8428909904907917e-02, -5.2310318986601989e-02,
		+2.5837172936714375e-01, -1.1942347907589732e-01, +4.4350329009194173e-01,
		+1.1988956633676386e-01, +2.7879399381445569e-01, +2.7335327852770996e-01,
		+1.2095495317582093e-01, +5.0822993667190834e-02, +5.1938776470139614e-01,
		-3.1033791506044228e-01, +4.5485802026695138e-01, -2.7594190219192083e-01,
		+6.5046602806975073e-01, -3.7949205847255349e-02,
	}

	assert.EqualWithin(ComputeTridiagonal(a, b, c, d), x, 1e-15, t)
}
